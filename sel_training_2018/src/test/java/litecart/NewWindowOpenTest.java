package litecart;

import org.junit.Test;
import org.openqa.selenium.By;
import org.openqa.selenium.WebElement;

import java.util.List;
import java.util.Set;

public class NewWindowOpenTest extends TestBase{

    private void OpenCountry(String country) {
        driver.get("http://localhost/litecart/admin/?app=countries&doc=countries");

        List<WebElement> countries = driver.findElements(By.cssSelector("form[name=countries_form] .dataTable tr.row td:nth-child(5) a"));
        for( WebElement c: countries) {
            if (c.getText().equals(country)) {
                c.click();
                return;
            }
        }
    }



    @Test
    public void NewWindowOpenTest() {
        LoginAdmin();

        OpenCountry("Afghanistan");

        List<WebElement> externalLinks = driver.findElements(By.cssSelector("i.fa-external-link"));
        for (WebElement externalLink: externalLinks){

            String mainWindow = driver.getWindowHandle();
            Set<String> oldWindows = driver.getWindowHandles();
            externalLink.click();
            String newWindow = wait.until(anyWindowOtherThan(oldWindows));
            driver.switchTo().window(newWindow);
            System.out.println("New window opened with title: " + driver.getTitle());
            driver.close();
            driver.switchTo().window(mainWindow);

        }

    }
}
